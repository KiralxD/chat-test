<!DOCTYPE html>
<html lang="pt-br">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <meta http-equiv="X-UA-Compatible" content="ie=edge">
   <title>ADMIN CHATBOT</title>
   <script src="js/jquery.min.js"></script>
   <script src="js/popper.min.js"></script>
   <script src="js/bootstrap.min.js" type="text/javascript"></script>
   <link rel="stylesheet" href="css/login.css" />
   <link rel="stylesheet" href="css/Joanna.css" />
   <meta charset="utf-8" />
   <link rel="icon" type="image/ico" href="img/favicon.ico"/>
   <meta http-equiv="cache-control" content="no-cache" />
   <meta http-equiv="expires" content="0" />
   <meta http-equiv="pragma" content="no-cache" />


   <!--CDNS-->
   <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"></script>
   <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" />
   <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
   <link rel="shortcut icon" href="../assets/img/logomi.png">
   <!--CDNS-->

<body>

   
      <!-- Start CSS minifier -->
      <style>
         input[type="text"], input[type="password"] {margin: 10px 0px;width: 83%;padding: 10px 0px 10px 39px;}input[type="text"] {background: url("https://user-images.githubusercontent.com/47280551/67255247-71cb6d00-f457-11e9-89af-9671a1df0a21.png") no-repeat 9px 8px;background-size: 22px;}input[type="password"] {background: url("https://user-images.githubusercontent.com/47280551/67255248-72640380-f457-11e9-916c-5db4eccfe058.png") no-repeat 6px 6px;background-size: 26px;}body {text-align: center;}a:hover {color: #fff !important;} input[type="text"], input[type="password"] {margin: 10px 0px;width: 83%;padding: 10px 0px 10px 39px;}input[type="text"] {background: url("https://user-images.githubusercontent.com/47280551/67255247-71cb6d00-f457-11e9-89af-9671a1df0a21.png") no-repeat 9px 8px;background-size: 22px;}input[type="password"] {background: url("https://user-images.githubusercontent.com/47280551/67255248-72640380-f457-11e9-916c-5db4eccfe058.png") no-repeat 6px 6px;background-size: 26px;}body {text-align: center;}a:hover {color: #fff !important;}
      </style>
        <!-- Start CSS minifier -->


   <header class="site-header">
      <div class="container">
         <div class="site-header-header">
            <div class="site-header-brand">
               </a>
            </div>
         </div>
         </nav>
      </div>
      </div>
   </header>


   <!--Form-->
   <div class="main-w3l">
      <div class="w3layouts-main">
         <img src="https://user-images.githubusercontent.com/47280551/67255246-71cb6d00-f457-11e9-8217-ee31bf0a9917.png"
            class="avatar" />
         <center>
            <input id="user_name" type="text" name="user_name" value="username" required="" onfocus="this.value = '';"
               onblur="if (this.value == '') {this.value = 'E-Mail';}" onchange="alertFalse()" />
            <input id="password" value="Senha" name="password" type="password" required="" onfocus="this.value = '';"
               onblur="if (this.value == '') {this.value = 'password';}" onchange="alertFalse()" />
            <input type="submit" value="Entrar" name="login" onclick="entrar()">
         </center>
         <!--Form-->

         <!--Footer-->
         <div id="desc" class="footer-copyright text-center py-3">© 2020 Copyright:
            <a href="https://www.linkedin.com/in/erlanlucio/" Target="_blank" rel="noopener noreferrer">
               Erlan Lucio</a>
         </div>
         <!--//Footer-->


         <!--Alerts-->
         <div class="alert alert-danger alert-dismissible" id="alert" style="display: none">
            <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
            <font color="red">
               <strong>Acesso NEGADO!</strong> Usuário e/ou senha incorreto(s).
            </font>
         </div>
         <!--Alerts-->


         <script type="text/javascript">
            localStorage.setItem("objJSON", "");
            function entrar() {
               const user_name = document
                  .getElementById("user_name")
                  .value.toString()
                  .trim();
               const password = document
                  .getElementById("password")
                  .value.toString()
                  .trim();

               const http = new XMLHttpRequest();
               http.open("POST", "/user/search", true);
               http.setRequestHeader(
                  "Content-Type",
                  "application/x-www-form-urlencoded"
               );

               http.onreadystatechange = function () {
                  if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
                     let objJSON = JSON.parse(http.responseText);
                     if (
                        objJSON.user_name == user_name &&
                        objJSON.password == password
                     ) {
                        alertFalse();
                        localStorage.setItem("objJSON", JSON.stringify(objJSON));
                        window.location.href = `/index?user_name=${user_name}&password=${password}`;
                     } else {
                        alertTrue();
                     }
                  } else if (this.readyState === 2) {
                     alertTrue();
                  }
               };
               http.send(`user_name=${user_name}&password=${password}`);
            }

            function alertFalse() {
               const Alert = document.getElementById("alert");
               Alert.style.display = "none";
            }

            function alertTrue() {
               setTimeout(function () {
                  const Alert = document.getElementById("alert");
                  Alert.style.display = "block";
                  document.getElementById("user_name").value = "";
                  document.getElementById("password").value = "";
                  document.getElementById("user_name").focus();
               }, 1000);
            }
         </script>
</body>

</html>